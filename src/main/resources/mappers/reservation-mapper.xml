<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="reservationMapper">
	<resultMap type="Reservation" id="reservationResultSet">
		
	</resultMap>
	
	<resultMap type="Coupon" id="couponResultSet">
		<id column="coupon_code" property="couponCode"/>
	  	<result column="coupon_name" property="couponName"/>
	  	<result column="start_date" property="startDate"/>
	  	<result column="expiration_period" property="expirationPeriod"/>
	  	<result column="discount_rate" property="discountRate"/>
	</resultMap>
	
	<resultMap type="Grade" id="gradeResultSet">
		<id column="grade_code" property="gradeCode"/>
	  	<result column="grade_name" property="gradeName"/>
	  	<result column="standard" property="standard"/>
	  	<result column="discount" property="discount"/>
	</resultMap>
	
	<resultMap type="Seat" id="SeatResultSet">
		<id column="seat_no" property="seatNo"/>
	  	<result column="seat_price" property="seatPrice"/>
	  	<result column="status" property="status"/>
	</resultMap>
	
	<select id="seatAllCount" resultType="_int">
		select count(*) 
		from seat
	</select>
	
	<select id="selectCouponList"   parameterType="_int" resultMap="couponResultSet">
		select coupon_code,coupon_name, start_date, expiration_period,discount_rate
		from member_coupon join coupon using(coupon_code) where user_no=#{userNo}
	</select>
	
	<select id="selectGrade" parameterType="_int" resultMap="gradeResultSet">
		select grade_code,grade_Name,standard,discount 
		from member 
		join grade using(grade_code) where user_no = #{userNo}
	</select>
	
	<select id="selectSeat" parameterType="_int" resultMap="SeatResultSet">
		select seat_no, seat_price, status
		from seat 
		where seat_no = #{seat_no}
	</select>
	
	<insert id="insertReservation" parameterType="Reservation">
		insert into reservation
		values(seq_reserveno.nextval, #{userNo}, 1, 
		#{refNo}, #{couponCode}, #{totalCost}, sysdate, 'X', #{gradeDiscount})
	</insert>
	
	<insert id="insertReservationTime" parameterType="Reservation">
		insert into reservation_time
		values(seq_reserveno.currval, #{usedDate}, #{startTime}, #{endTime})
	</insert>
	
	
	
	
	
</mapper>